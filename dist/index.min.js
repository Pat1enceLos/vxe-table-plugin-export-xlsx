!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-export",["exports","xe-utils","xlsx"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"),require("xlsx"));else{var r={exports:{}};t(r.exports,e.XEUtils,e.XLSX),e.VXETablePluginExport=r.exports.default}}(this,function(e,d,v){"use strict";var t;function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function r(e){var t=e.options,n=e.columns,r=e.datas,o=t.sheetName,i=t.type,a=t.isHeader,l=t.original,u={};a&&n.forEach(function(e){u[e.id]=l?e.property:e.getTitle()});var s=r.map(function(t){var r={};return n.forEach(function(e){r[e.id]=l?d.default.get(t,e.property):t[e.id]}),r}),c=v.utils.book_new(),f=v.utils.json_to_sheet((a?[u]:[]).concat(s),{skipHeader:!0});v.utils.book_append_sheet(c,f,o);var p=v.write(c,{bookType:i,bookSST:!1,type:"binary"});!function(e,t){if(window.Blob){var r=t.filename,n=t.type;if(navigator.msSaveBlob)navigator.msSaveBlob(e,r);else{var o=document.createElement("a");o.target="_blank",o.download="".concat(r,".").concat(n),o.href=URL.createObjectURL(e),document.body.appendChild(o),o.click(),document.body.removeChild(o)}}else console.error("[vxe-table-plugin-export] The current environment does not support exports.")}(new Blob([function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!==e.length;++n)r[n]=255&e.charCodeAt(n);return t}(p)],{type:"application/octet-stream"}),t)}function s(e){return e.replace(/^"/,"").replace(/"$/,"")}function n(e,t){var a=e.$table,l=e.columns,u=a.importCallback,r=t.target.files[0],n=new FileReader;n.onload=function(e){var t=v.read(e.target.result,{type:"binary"}),r=function(e,t){var r=t.split("\n"),n=[],o=[];if(r.length){var i=r.slice(1);r[0].split(",").forEach(function(e){var t=s(e);t&&n.push(t)}),i.forEach(function(e){if(e){var r={};e.split(",").forEach(function(e,t){r[n[t]]=s(e)}),o.push(r)}})}return{fields:n,rows:o}}(0,v.utils.sheet_to_csv(t.Sheets.Sheet1)),n=r.fields,o=r.rows,i=function(e,t){var r=[];return e.forEach(function(e){var t=e.property;t&&r.push(t)}),r.every(function(e){return t.includes(e)})}(l,n);i&&a.createData(o).then(function(e){return a.reloadData(e)}),u&&u(i)},n.readAsBinaryString(r)}function o(e,t){switch(e.options.type){case"xlsx":return n(e,t),!1}}function i(e){switch(e.options.type){case"xlsx":return r(e),!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExport=void 0,d=(t=d)&&t.__esModule?t:{default:t},v=function(e){if(e&&e.__esModule)return e;var t=a();if(t&&t.has(e))return t.get(e);var r={};if(null!=e){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}}r.default=e,t&&t.set(e,r);return r}(v);var l={install:function(e){Object.assign(e.types,{xlsx:1}),e.interceptor.mixin({"event.import":o,"event.export":i})}};e.VXETablePluginExport=l,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(l);var u=l;e.default=u});
!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-export",["exports","xe-utils","xlsx"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"),require("xlsx"));else{var r={exports:{}};t(r.exports,e.XEUtils,e.XLSX),e.VXETablePluginExport=r.exports.default}}(this,function(e,b,x){"use strict";var t;function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function r(e){var t=e.$table,r=e.options,n=e.columns,o=e.datas,a=r.sheetName,i=r.type,s=r.isHeader,u=r.original,l=r.message,c={};s&&n.forEach(function(e){c[e.id]=u?e.property:e.getTitle()});var p=o.map(function(t){var r={};return n.forEach(function(e){r[e.id]=u?b.default.get(t,e.property):t[e.id]}),r}),f=x.utils.book_new(),d=x.utils.json_to_sheet((s?[c]:[]).concat(p),{skipHeader:!0});x.utils.book_append_sheet(f,d,a);var v=x.write(f,{bookType:i,bookSST:!1,type:"binary"});!function(e,t){if(window.Blob){var r=t.filename,n=t.type;if(navigator.msSaveBlob)navigator.msSaveBlob(e,r);else{var o=document.createElement("a");o.target="_blank",o.download="".concat(r,".").concat(n),o.href=URL.createObjectURL(e),document.body.appendChild(o),o.click(),document.body.removeChild(o)}}else console.error("[vxe-table-plugin-export] The current environment does not support exports.")}(new Blob([function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!==e.length;++n)r[n]=255&e.charCodeAt(n);return t}(v)],{type:"application/octet-stream"}),r),l&&t.$XModal.message({message:y("vxe.table.expSuccess"),status:"success"})}function c(e){return e.replace(/^"/,"").replace(/"$/,"")}function n(e){var i=e.$table,s=e.columns,u=e.options,t=e.file,l=i._importCallback,r=new FileReader;r.onload=function(e){var t=x.read(e.target.result,{type:"binary"}),r=function(e,t){var r=t.split("\n"),n=[],o=[];if(r.length){var a=r.slice(1);r[0].split(",").forEach(function(e){var t=c(e);t&&n.push(t)}),a.forEach(function(e){if(e){var r={};e.split(",").forEach(function(e,t){r[n[t]]=c(e)}),o.push(r)}})}return{fields:n,rows:o}}(0,x.utils.sheet_to_csv(t.Sheets.Sheet1)),n=r.fields,o=r.rows,a=function(e,t){var r=[];return e.forEach(function(e){var t=e.property;t&&r.push(t)}),r.every(function(e){return t.includes(e)})}(s,n);a?(i.createData(o).then(function(e){"append"===u.mode?i.insertAt(e,-1):i.reloadData(e)}),u.message&&i.$XModal.message({message:y("vxe.table.impSuccess"),status:"success"})):u.message&&i.$XModal.message({message:y("vxe.error.impFields"),status:"error"}),l&&l(a)},r.readAsBinaryString(t)}function o(e){switch(e.options.type){case"xlsx":return n(e),!1}}function a(e){switch(e.options.type){case"xlsx":return r(e),!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExport=void 0,b=(t=b)&&t.__esModule?t:{default:t},x=function(e){if(e&&e.__esModule)return e;var t=i();if(t&&t.has(e))return t.get(e);var r={};if(null!=e){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}}r.default=e,t&&t.set(e,r);return r}(x);var s={install:function(e){Object.assign(e.types,{xlsx:1}),e.interceptor.mixin({"event.import":o,"event.export":a}),s.t=e.t}};function y(e){if(s.t)return s.t(e)}e.VXETablePluginExport=s,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(s);var u=s;e.default=u});
!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-export",["exports","xe-utils","xlsx"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"),require("xlsx"));else{var r={exports:{}};t(r.exports,e.XEUtils,e.XLSX),e.VXETablePluginExport=r.exports.default}}(this,function(e,y,g){"use strict";var t;function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function r(e){var n=e.$table,t=e.options,o=e.columns,r=e.datas,a=t.sheetName,i=t.type,s=t.isHeader,l=t.isFooter,u=t.original,c=t.message,f=t.footerFilterMethod,p={},d=[];s&&o.forEach(function(e){p[e.id]=(u?e.property:e.getTitle())||""});var v=r.map(function(t){var r={};return o.forEach(function(e){r[e.id]=u?y.default.get(t,e.property):t[e.id]}),r});if(l){var b=n.footerData;(f?b.filter(f):b).forEach(function(t){var r={};o.forEach(function(e){r[e.id]=t[n.getColumnIndex(e)]||""}),d.push(r)})}var m=g.utils.book_new(),h=g.utils.json_to_sheet((s?[p]:[]).concat(v).concat(d),{skipHeader:!0});g.utils.book_append_sheet(m,h,a);var x=g.write(m,{bookType:i,bookSST:!1,type:"binary"});!function(e,t){if(window.Blob){var r=t.filename,n=t.type;if(navigator.msSaveBlob)navigator.msSaveBlob(e,r);else{var o=document.createElement("a");o.target="_blank",o.download="".concat(r,".").concat(n),o.href=URL.createObjectURL(e),document.body.appendChild(o),o.click(),document.body.removeChild(o)}}else console.error(w("vxe.error.notExp"))}(new Blob([function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!==e.length;++n)r[n]=255&e.charCodeAt(n);return t}(x)],{type:"application/octet-stream"}),t),!1!==c&&n.$XModal.message({message:w("vxe.table.expSuccess"),status:"success"})}function f(e){return e.replace(/^"/,"").replace(/"$/,"")}function n(e){var i=e.$table,s=e.columns,l=e.options,t=e.file,u=i._importCallback,c=i._importResolve,r=new FileReader;r.onload=function(e){var t=g.read(e.target.result,{type:"binary"}),r=function(e,t){var r=t.split("\n"),n=[],o=[];if(r.length){var a=r.slice(1);r[0].split(",").forEach(function(e){var t=f(e);t&&n.push(t)}),a.forEach(function(e){if(e){var r={};e.split(",").forEach(function(e,t){r[n[t]]=f(e)}),o.push(r)}})}return{fields:n,rows:o}}(0,g.utils.sheet_to_csv(t.Sheets.Sheet1)),n=r.fields,o=r.rows,a=function(e,t){var r=[];return e.forEach(function(e){var t=e.property;t&&r.push(t)}),r.every(function(e){return t.includes(e)})}(s,n);a?(i.createData(o).then(function(e){"append"===l.mode?i.insertAt(e,-1):i.reloadData(e)}),!1!==l.message&&i.$XModal.message({message:w("vxe.table.impSuccess"),status:"success"})):!1!==l.message&&i.$XModal.message({message:w("vxe.error.impFields"),status:"error"}),c?(c(a),i._importResolve=null):u&&(u(a),i._importCallback=null)},r.readAsBinaryString(t)}function o(e){switch(e.options.type){case"xlsx":return n(e),!1}}function a(e){switch(e.options.type){case"xlsx":return r(e),!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExport=void 0,y=(t=y)&&t.__esModule?t:{default:t},g=function(e){if(e&&e.__esModule)return e;var t=i();if(t&&t.has(e))return t.get(e);var r={};if(null!=e){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}}r.default=e,t&&t.set(e,r);return r}(g);var s={install:function(e){Object.assign(e.types,{xlsx:1}),e.interceptor.mixin({"event.import":o,"event.export":a}),s.t=e.t}};function w(e){if(s.t)return s.t(e)}e.VXETablePluginExport=s,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(s);var l=s;e.default=l});
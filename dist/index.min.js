!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-export-xlsx",["exports","xe-utils","xlsx"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"),require("xlsx"));else{var n={exports:{}};t(n.exports,e.XEUtils,e.XLSX),e.VXETablePluginExportXLSX=n.exports.default}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,g,y){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}var w;function n(e){var o=e.$table,t=e.options,a=e.columns,n=e.datas,r=t.sheetName,i=t.isHeader,s=t.isFooter,l=t.original,u=t.message,f=t.footerFilterMethod,c={},d=[],p=[];i&&a.forEach(function(e){c[e.id]=l?e.property:e.getTitle(),p.push({wpx:g.default.toInteger(.8*e.renderWidth)})});var m=n.map(function(t){return a.forEach(function(e){t[e.id]=function(e,t){if(t)switch(e.cellType){case"string":break;case"number":if(!isNaN(t))return Number(t);break;default:if(t.length<17&&!isNaN(t))return Number(t)}return t}(e,t[e.id])}),t});if(s){var v=o.getTableData().footerData;(f?v.filter(f):v).forEach(function(n){var r={};a.forEach(function(e){var t;r[e.id]=(t=e,n[o.$getColumnIndex(t)])}),d.push(r)})}var x=y.default.utils.book_new(),b=y.default.utils.json_to_sheet((i?[c]:[]).concat(m).concat(d),{skipHeader:!0});b["!cols"]=p,y.default.utils.book_append_sheet(x,b,r);var h=y.default.write(x,{bookType:"xlsx",bookSST:!1,type:"binary"});!function(e,t){if(window.Blob){var n=t.filename,r=t.type;if(navigator.msSaveBlob)navigator.msSaveBlob(e,"".concat(n,".").concat(r));else{var o=document.createElement("a");o.target="_blank",o.download="".concat(n,".").concat(r),o.href=URL.createObjectURL(e),document.body.appendChild(o),o.click(),document.body.removeChild(o)}}else console.error(w.t("vxe.error.notExp"))}(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!==e.length;++r)n[r]=255&e.charCodeAt(r);return t}(h)],{type:"application/octet-stream"}),t),!1!==u&&w.modal.message({message:w.t("vxe.table.expSuccess"),status:"success"})}function d(e){return e.replace(/^"/,"").replace(/"$/,"")}function r(e){var l=e.columns,u=e.options,t=e.file,f=e.$table,c=f._importResolve,n=new FileReader;n.onload=function(e){var t,n,r=y.default.read(e.target.result,{type:"binary"}),o=function(e){var t=e.split("\n"),r=[],o=[];if(t.length){var n=t.slice(1);t[0].split(",").map(d),n.forEach(function(e){if(e){var n={};e.split(",").forEach(function(e,t){r[t]&&(n[r[t]]=d(e))}),o.push(n)}})}return{fields:r,rows:o}}(y.default.utils.sheet_to_csv(r.Sheets.Sheet1)),a=o.fields,i=o.rows,s=(t=a,n=[],l.forEach(function(e){var t=e.property;t&&n.push(t)}),n.every(function(e){return t.includes(e)}));s?(f.createData(i).then(function(e){"append"===u.mode?f.insertAt(e,-1):f.reloadData(e)}),!1!==u.message&&w.modal.message({message:g.default.template(w.t("vxe.table.impSuccess"),[i.length]),status:"success"})):!1!==u.message&&w.modal.message({message:w.t("vxe.error.impFields"),status:"error"}),c&&(c(s),f._importResolve=null)},n.readAsBinaryString(t)}function o(e){if("xlsx"===e.options.type)return r(e),!1}function a(e){if("xlsx"===e.options.type)return n(e),!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExportXLSX=void 0,g=t(g),y=t(y);var i={install:function(e){var t=e.interceptor;w=e,Object.assign(e.types,{xlsx:1}),t.mixin({"event.import":o,"event.export":a})}};e.VXETablePluginExportXLSX=i,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(i);var s=i;e.default=s});
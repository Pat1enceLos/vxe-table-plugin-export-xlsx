!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-export",["exports","xe-utils","xlsx"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"),require("xlsx"));else{var n={exports:{}};t(n.exports,e.XEUtils,e.XLSX),e.VXETablePluginExport=n.exports.default}}(this,function(e,d,v){"use strict";var t;function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function n(e){var t=e.options,r=e.columns,n=e.datas,o=t.sheetName,i=t.type,a=t.isHeader,l=t.original,u={};a&&r.forEach(function(e){u[e.id]=l?e.property:e.getTitle()});var s=n.map(function(t){var n={};return r.forEach(function(e){n[e.id]=l?d.default.get(t,e.property):t[e.id]}),n}),c=v.utils.book_new(),p=v.utils.json_to_sheet((a?[u]:[]).concat(s),{skipHeader:!0});v.utils.book_append_sheet(c,p,o);var f=v.write(c,{bookType:i,bookSST:!1,type:"binary"});!function(e,t){if(window.Blob){var n=t.filename,r=t.type;if(navigator.msSaveBlob)navigator.msSaveBlob(e,n);else{var o=document.createElement("a");o.target="_blank",o.download="".concat(n,".").concat(r),o.href=URL.createObjectURL(e),document.body.appendChild(o),o.click(),document.body.removeChild(o)}}else console.error("[vxe-table-plugin-export] The current environment does not support exports.")}(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!==e.length;++r)n[r]=255&e.charCodeAt(r);return t}(f)],{type:"application/octet-stream"}),t)}function c(e){return e.replace(/^"/,"").replace(/"$/,"")}function r(e){var a=e.$table,l=e.columns,u=e.options,t=e.file,s=a._importCallback,n=new FileReader;n.onload=function(e){var t=v.read(e.target.result,{type:"binary"}),n=function(e,t){var n=t.split("\n"),r=[],o=[];if(n.length){var i=n.slice(1);n[0].split(",").forEach(function(e){var t=c(e);t&&r.push(t)}),i.forEach(function(e){if(e){var n={};e.split(",").forEach(function(e,t){n[r[t]]=c(e)}),o.push(n)}})}return{fields:r,rows:o}}(0,v.utils.sheet_to_csv(t.Sheets.Sheet1)),r=n.fields,o=n.rows,i=function(e,t){var n=[];return e.forEach(function(e){var t=e.property;t&&n.push(t)}),n.every(function(e){return t.includes(e)})}(l,r);i&&a.createData(o).then(function(e){"append"===u.mode?a.insertAt(e,-1):a.reloadData(e)}),s&&s(i)},n.readAsBinaryString(t)}function o(e){switch(e.options.type){case"xlsx":return r(e),!1}}function i(e){switch(e.options.type){case"xlsx":return n(e),!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExport=void 0,d=(t=d)&&t.__esModule?t:{default:t},v=function(e){if(e&&e.__esModule)return e;var t=a();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}}n.default=e,t&&t.set(e,n);return n}(v);var l={install:function(e){Object.assign(e.types,{xlsx:1}),e.interceptor.mixin({"event.import":o,"event.export":i})}};e.VXETablePluginExport=l,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(l);var u=l;e.default=u});